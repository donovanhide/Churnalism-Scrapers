/*
soma-template - v0.1.8 - 2013-05-02
http://soundstep.github.com/soma-template/
http://www.soundstep.com
MIT licence 2013
*/
(function(e,t){"use strict";function n(e){return"[object Array]"===Object.prototype.toString.apply(e)}function i(e){return"object"==typeof e}function r(e){return"string"==typeof e}function a(e){return e?e.nodeType>0:!1}function s(e){return e&&e.nodeType&&3===e.nodeType}function o(e){return e&&"function"==typeof e}function l(e){return null!==e&&e!==t}function u(e){return""===e||e===!0||"true"===e||!l(e)}function h(e){return e&&o(e.toString)&&"[object Expression]"==""+e}function p(e){return r(e)?!!e.match(bt.func):!1}function c(e){return e&&e.parent&&St.get(e.element)}function d(e){return e.replace(bt.escape,"\\$&")}function f(e,t){var n=ht.start().replace(/\\/g,""),i="",r=t?e:n;r.length>1&&(i="|\\"+r.substr(0,1)+"(?!\\"+r.substr(1,1)+")[^"+r.substr(0,1)+"]*"),bt.sequence=RegExp(ht.start()+".+?"+ht.end()+"|[^"+ht.start()+"]+"+i,"g"),bt.token=RegExp(ht.start()+".*?"+ht.end(),"g"),bt.expression=RegExp(ht.start()+"|"+ht.end(),"gm")}function m(e){return e.replace(bt.trim,"")}function v(e){return bt.string.test(e)?e.substr(1,e.length-2):e}function g(e){return""===e[0]&&e.shift(),""===e[e.length-1]&&e.pop(),e}function b(e){return e.replace(bt.expression,"")}function y(e){return e.replace(bt.depth,"")}function E(e,t){e.parentNode&&e.parentNode.insertBefore(t,e)}function N(e,t){e.parentNode&&e.parentNode.insertBefore(t,e.nextSibling)}function w(e,t){w=document.documentElement.classList?function(e,t){e.classList.remove(t)}:function(e,t){if(!e||!e.className)return!1;var n=RegExp("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(n,"$2")},w(e,t)}function x(){function e(){return++r}function n(t){if(t){if("object"!=typeof t)return t;var n;try{n=t.hashkey?t.hashkey:t.hashkey=e()}catch(i){}return n}}var i={},r=1;this.remove=function(e){delete i[n(e)]},this.get=function(e){return i[n(e)]},this.put=function(e,t){i[n(e)]=t},this.has=function(e){return i[n(e)]!==t},this.getData=function(){return i},this.dispose=function(){for(var e in i)delete i[e];this.length=0}}function R(e,t){var n=e.match(bt.repeat);if(n){var i=n[2],r=new kt(i);return r.getValue(t)}}function k(e,t,n){var i=e.match(bt.repeat);if(i){var r=i[1];t[r]=n}}function S(e,t){var n=e.node||e.attribute.node,i=n.template.watchers,r=n.element;if(!i)return t;var a=i.get(r);!a&&s(n.element)&&n.parent&&(a=i.get(n.parent.element));var u=a?a:i.get(e.pattern);if(o(u)){var h=u(e.value,t,e.pattern,n.scope,n,e.attribute);if(l(h))return h}return t}function T(e,t){for(var n=$(t),i=e;n>0;)i=i._parent?i._parent:i,n--;return i}function A(e,t){var n=new kt(t);return _(e,n.pattern,n.path,n.params)}function _(e,n,i,r,a,s,u){if(bt.string.test(n))return v(n);var h=[];if(!u&&r)for(var p=0,c=r.length;c>p;p++)h.push(A(e,r[p]));else h=u;if(s)return h;var d=T(e,n);if(n=n.replace(/..\//g,""),i=i.replace(/..\//g,""),!d)return t;var f=d,m=i.split(/\.|\[|\]/g);if(m.length>0)for(var g=0,b=m.length;b>g;g++)if(""!==m[g]&&(f=f[m[g]]),!l(f))return d._parent?_(d._parent,n,i,r,a,s,h):t;return o(f)?a?f:f.apply(null,h):f}function L(e){var t=e.split("(")[0];return t=y(t)}function V(e){return g(e.split(bt.params))}function $(e){var t=e.split("(")[0],n=t.match(bt.depth);return n?n.length:0}function D(e,t,n){var i=new wt(e,t);i.previousSibling=e.previousSibling,i.nextSibling=e.nextSibling;for(var r,a,s,o=[],l=[],u=e.attributes,h=0,p=u&&u.length;p>h;h++)r=u[h],r.specified&&(a=r.name,s=r.value,a===ut.attributes.skip&&(i.skip=""===s||"true"===s),a===ut.attributes.html&&(i.html=""===s||"true"===s),a!==ut.attributes.repeat||n||(i.repeater=s),(H(a+":"+s)||a===ut.attributes.repeat||a===ut.attributes.skip||a===ut.attributes.html||a===ut.attributes.show||a===ut.attributes.hide||a===ut.attributes.href||a===ut.attributes.checked||a===ut.attributes.disabled||a===ut.attributes.multiple||a===ut.attributes.readonly||a===ut.attributes.selected||-1!==s.indexOf(ut.attributes.cloak))&&o.push(new xt(a,s,i)),dt[a]&&!n&&(l.push({name:dt[a],value:s}),o.push(new xt(a,s,i))));i.attributes=o;for(var c=0,d=l.length;d>c;c++)i.addEvent(l[c].name,l[c].value);return i}function H(e){var t=e.match(bt.token);return t&&t.length>0}function M(e){return bt.content.test(e)}function q(e){if(e){var t=e.nodeType;return e&&t?8===t?!1:3!==t||M(e.nodeValue)||H(e.nodeValue)?!0:!1:!1}}function C(e,t,n,i){if(q(t)){var r;if(i?(r=i,r.parent=n):r=D(t,n?n.scope:new Nt(lt)._createChild(),n&&(n.repeater||n.isRepeaterDescendant)),n&&(n.repeater||n.isRepeaterDescendant)&&(r.isRepeaterDescendant=!0),r.template=e,!r.skip){for(var a=t.firstChild;a;){var s=C(e,a,r);s&&(s.parent=r,r.children.push(s)),a=a.nextSibling}return r}}}function P(e,t){j(e);for(var n in t)e[n]=t[n]}function j(e){for(var t in e)"_"!==t.substr(0,1)&&(e[t]=null,delete e[t])}function O(e){if(!e.repeater&&e.children&&!c(e))for(var t=0,n=e.children.length;n>t;t++)e.children[t].update()}function I(e){if(e.children&&!c(e))for(var t=0,n=e.children.length;n>t;t++)e.children[t].render()}function B(e){var t,i=R(e.repeater,e.scope);if(n(i)){for(var r=0,a=i.length,s=e.childrenRepeater.length,o=a>s?a:s;o>r;r++)a>r?t=G(e,r,i[r],ct.index,r,t):(e.parent.element.removeChild(e.childrenRepeater[r].element),e.childrenRepeater[r].dispose());e.childrenRepeater.length>i.length&&(e.childrenRepeater.length=i.length)}else{var l=-1;for(var u in i)l++,t=G(e,l,i[u],ct.key,u,t);for(var h=l;l++<e.childrenRepeater.length-1;)e.parent.element.removeChild(e.childrenRepeater[l].element),e.childrenRepeater[l].dispose();e.childrenRepeater.length=h+1}e.element.parentNode&&e.element.parentNode.removeChild(e.element)}function F(e,t){var n=new wt(e,t.scope._createChild());if(t.attributes){for(var i=[],r=0,a=t.attributes.length;a>r;r++){if(n.renderAsHtml=t.renderAsHtml,t.attributes[r].name===ut.attributes.skip&&(n.skip=""===t.attributes[r].value||"true"===t.attributes[r].value),t.attributes[r].name===ut.attributes.html&&(n.html=""===t.attributes[r].value||"true"===t.attributes[r].value),t.attributes[r].name!==pt.repeat){var s=new xt(t.attributes[r].name,t.attributes[r].value,n);i.push(s)}dt[t.attributes[r].name]&&n.addEvent(dt[t.attributes[r].name],t.attributes[r].value)}n.attributes=i}return n}function G(e,t,n,i,r,a){var s=e.childrenRepeater[t];if(s)return k(e.repeater,s.scope,n),s.scope[i]=r,s.update(),s.render(),s.element;var o=e.element.cloneNode(!0),l=F(o,e);return l.isRepeaterChild=!0,l.parent=e.parent,l.template=e.template,e.childrenRepeater[t]=l,k(e.repeater,l.scope,n),l.scope[i]=r,C(e.template,o,e.parent,l),l.update(),l.render(),a?N(a,o):e.previousSibling?N(e.previousSibling,o):e.nextSibling?E(e.nextSibling,o):e.parent.element.appendChild(o),o}function W(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else{n.$$guid||(n.$$guid=W.guid++),e.events||(e.events={});var i=e.events[t];i||(i=e.events[t]={},e["on"+t]&&(i[0]=e["on"+t])),i[n.$$guid]=n,e["on"+t]=U}}function z(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.events&&e.events[t]&&delete e.events[t][n.$$guid]}function U(e){var t=!0;e=e||X(((this.ownerDocument||this.document||this).parentWindow||window).event);var n=this.events[e.type];for(var i in n)this.$$handleEvent=n[i],this.$$handleEvent(e)===!1&&(t=!1);return t}function X(e){return e.preventDefault=X.preventDefault,e.stopPropagation=X.stopPropagation,e}function J(e,n,i){At=i===t?Number.MAX_VALUE:i,K(e,n,0,!0)}function K(e,t,n,i){if(!a(e))throw Error("Error in soma.template.parseEvents, only a DOM Element can be parsed.");if(i&&Q(e,t),0!==At)for(var r=e.firstChild;r;)1===r.nodeType&&At>n&&(K(r,t,++n),Q(r,t)),r=r.nextSibling}function Q(e,t){for(var n,i,r,a=e.attributes,s=0,l=a&&a.length;l>s;s++)if(n=a[s],n.specified&&(i=n.name,r=n.value,dt[i])){var u=Y(t,r,e);u&&o(u)&&(W(e,dt[i],u),_t.push({element:e,type:dt[i],handler:u}))}}function Y(e,t){var n=t.match(bt.func);if(n){var i=n[1];if(o(e[i]))return e[i]}}function Z(e){for(var t=_t.length,n=0;--t>=n;){var i=_t[t];(e===i.element||Et(e,i.element))&&(z(i.element,i.type,i.handler),_t.splice(t,1))}}function et(e,t,n){var i=tt(t);n(i,i.scope,i.element,i.node)}function tt(t,n){var i;if(r(t)){if(!a(n))throw Error(e.template.errors.TEMPLATE_STRING_NO_ELEMENT);n.innerHTML=t,i=n}else{if(!a(t))throw Error(e.template.errors.TEMPLATE_NO_PARAM);a(n)?(n.innerHTML=t.innerHTML,i=n):i=t}nt(i)&&(nt(i).dispose(),St.remove(i));var s=new Tt(i);return St.put(i,s),s}function nt(e){return St.get(e)}function it(){for(var e in St.getData())St.get(e).render()}function rt(e){if(null===e&&(ot={},lt={}),l(e)&&i(e))for(var t in e)e.hasOwnProperty(t)&&(ot[t]=lt[t]=e[t]);return ot}e.template=e.template||{},e.template.version="0.1.8",e.template.errors={TEMPLATE_STRING_NO_ELEMENT:"Error in soma.template, a string template requirement a second parameter: an element target - soma.template.create('string', element)",TEMPLATE_NO_PARAM:"Error in soma.template, a template requires at least 1 parameter - soma.template.create(element)"};var at="{{",st="}}",ot={},lt={},ut=e.template.settings=e.template.settings||{};ut.autocreate=!0;var ht=ut.tokens={start:function(e){return l(e)&&""!==e&&(at=d(e),f(e,!0)),at},end:function(e){return l(e)&&""!==e&&(st=d(e),f(e,!1)),st}},pt=ut.attributes={skip:"data-skip",repeat:"data-repeat",src:"data-src",href:"data-href",show:"data-show",hide:"data-hide",cloak:"data-cloak",checked:"data-checked",disabled:"data-disabled",multiple:"data-multiple",readonly:"data-readonly",selected:"data-selected",template:"data-template",html:"data-html"},ct=ut.vars={index:"$index",key:"$key"},dt=ut.events={};ut.eventsPrefix="data-";var ft="click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup focus blur change select selectstart scroll copy cut paste mousewheel keypress error contextmenu input textinput drag dragenter dragleave dragover dragend dragstart dragover drop load submit reset search resize beforepaste beforecut beforecopy";ft+=" touchstart touchend touchmove touchenter touchleave touchcancel gesturestart gesturechange gestureend";for(var mt=ft.split(" "),vt=-1,gt=mt.length;gt>++vt;)dt[ut.eventsPrefix+mt[vt]]=mt[vt];var bt={sequence:null,token:null,expression:null,escape:/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,trim:/^[\s+]+|[\s+]+$/g,repeat:/(.*)\s+in\s+(.*)/,func:/(.*)\((.*)\)/,params:/,\s+|,|\s+,\s+/,quote:/\"|\'/g,content:/[^.|^\s]/gm,depth:/..\//g,string:/^(\"|\')(.*)(\"|\')$/},yt=function(){if("object"!=typeof document)return t;for(var e,n=3,i=document.createElement("div"),r=i.getElementsByTagName("i");i.innerHTML="<!--[if gt IE "+ ++n+"]><i></i><![endif]-->",r[0];);return n>4?n:e}(),Et="object"!=typeof document?function(){}:document.documentElement.contains?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!!(i&&1===i.nodeType&&n.contains&&n.contains(i))}:document.documentElement.compareDocumentPosition?function(e,t){return t&&!!(16&e.compareDocumentPosition(t))}:function(e,t){for(;t=t.parentNode;)if(t===e)return!0;return!1},Nt=function(e){function t(e){var t=n(e);return t._parent=this,this._children.push(t),t}function n(e){var n=e||{};return n._parent=null,n._children=[],n._createChild=function(){return t.apply(n,arguments)},n}return n(e)},wt=function(e,n){this.element=e,this.scope=n,this.attributes=null,this.value=null,this.interpolation=null,this.invalidate=!1,this.skip=!1,this.repeater=null,this.isRepeaterDescendant=!1,this.isRepeaterChild=!1,this.parent=null,this.children=[],this.childrenRepeater=[],this.previousSibling=null,this.nextSibling=null,this.template=null,this.eventHandlers={},this.html=!1,s(this.element)&&(this.value=this.element.nodeValue,this.interpolation=new Rt(this.value,this,t))};wt.prototype={toString:function(){return"[object Node]"},dispose:function(){this.clearEvents();var e,t;if(this.children)for(e=0,t=this.children.length;t>e;e++)this.children[e].dispose();if(this.childrenRepeater)for(e=0,t=this.childrenRepeater.length;t>e;e++)this.childrenRepeater[e].dispose();if(this.attributes)for(e=0,t=this.attributes.length;t>e;e++)this.attributes[e].dispose();this.interpolation&&this.interpolation.dispose(),this.element=null,this.scope=null,this.attributes=null,this.attributesHashMap=null,this.value=null,this.interpolation=null,this.repeater=null,this.parent=null,this.children=null,this.childrenRepeater=null,this.previousSibling=null,this.nextSibling=null,this.template=null,this.eventHandlers=null},getNode:function(e){var t;if(e===this.element)return this;if(this.childrenRepeater.length>0){for(var n=0,i=this.childrenRepeater.length;i>n;n++)if(t=this.childrenRepeater[n].getNode(e))return t}else for(var r=0,a=this.children.length;a>r;r++)if(t=this.children[r].getNode(e))return t;return null},getAttribute:function(e){if(this.attributes)for(var t=0,n=this.attributes.length;n>t;t++){var i=this.attributes[t];if(i.interpolationName&&i.interpolationName.value===e)return i}},update:function(){if(!c(this)){if(l(this.interpolation)&&this.interpolation.update(),l(this.attributes))for(var e=0,t=this.attributes.length;t>e;e++)this.attributes[e].update();O(this)}},invalidateData:function(){if(!c(this)){this.invalidate=!0;var e,t;if(this.attributes)for(e=0,t=this.attributes.length;t>e;e++)this.attributes[e].invalidate=!0;for(e=0,t=this.childrenRepeater.length;t>e;e++)this.childrenRepeater[e].invalidateData();for(e=0,t=this.children.length;t>e;e++)this.children[e].invalidateData()}},addEvent:function(e,t){if(!this.repeater){this.eventHandlers[e]&&this.removeEvent(e);var n=this.scope,i=function(e){var i=new kt(t,this.node),r=i.getValue(n,!0),a=i.getValue(n,!1,!0);a.unshift(e),r&&r.apply(null,a)};this.eventHandlers[e]=i,W(this.element,e,i)}},removeEvent:function(e){z(this.element,e,this.eventHandlers[e]),this.eventHandlers[e]=null,delete this.eventHandlers[e]},clearEvents:function(){if(this.eventHandlers)for(var e in this.eventHandlers)this.removeEvent(e,this.eventHandlers[e]);if(this.children)for(var t=0,n=this.children.length;n>t;t++)this.children[t].clearEvents();if(this.childrenRepeater)for(var i=0,r=this.childrenRepeater.length;r>i;i++)this.childrenRepeater[i].clearEvents()},render:function(){if(!c(this)){if(this.invalidate&&(this.invalidate=!1,s(this.element)&&(this.value=this.parent&&this.parent.html?this.parent.element.innerHTML=this.interpolation.render():this.element.nodeValue=this.interpolation.render())),this.attributes)for(var e=0,t=this.attributes.length;t>e;e++)this.attributes[e].render();this.repeater?B(this):I(this)}}};var xt=function(e,t,n){this.name=e,this.value=t,this.node=n,this.interpolationName=new Rt(this.name,null,this),this.interpolationValue=new Rt(this.value,null,this),this.invalidate=!1};xt.prototype={toString:function(){return"[object Attribute]"},dispose:function(){this.interpolationName&&this.interpolationName.dispose(),this.interpolationValue&&this.interpolationValue.dispose(),this.interpolationName=null,this.interpolationValue=null,this.node=null,this.name=null,this.value=null,this.previousName=null},update:function(){this.interpolationName.update(),this.interpolationValue.update()},render:function(){function e(e,t){7===yt&&"class"===e?r.className=t:r.setAttribute(e,t)}function t(e,t,n){u(t)?r.setAttribute(n,n):r.removeAttribute(n)}function n(e,t){r.setAttribute("src",t)}function i(e,t){r.setAttribute("href",t)}if(!this.node.repeater){var r=this.node.element;this.invalidate&&(this.invalidate=!1,this.previousName=this.name,this.name=l(this.interpolationName.render())?this.interpolationName.render():this.name,this.value=l(this.interpolationValue.render())?this.interpolationValue.render():this.value,this.name===pt.src?n(this.name,this.value):this.name===pt.href?i(this.name,this.value):(this.node.isRepeaterChild&&7===yt||this.node.element.removeAttribute(this.interpolationName.value),this.previousName&&(7===yt&&"class"===this.previousName?this.node.element.className="":this.node.isRepeaterChild&&7===yt||this.node.element.removeAttribute(this.previousName)),e(this.name,this.value,this.previousName))),"class"===this.name&&-1!==this.value.indexOf(ut.attributes.cloak)&&w(this.node.element,ut.attributes.cloak),this.name===pt.hide&&(r.style.display=u(this.value)?"none":"block"),this.name===pt.show&&(r.style.display=u(this.value)?"block":"none"),this.name===pt.checked&&(t(this.name,this.value,"checked"),r.checked=u(this.value)?!0:!1),this.name===pt.disabled&&t(this.name,this.value,"disabled"),this.name===pt.multiple&&t(this.name,this.value,"multiple"),this.name===pt.readonly&&(7===yt?r.readOnly=u(this.value)?!0:!1:t(this.name,this.value,"readonly")),this.name===pt.selected&&t(this.name,this.value,"selected")}}};var Rt=function(e,t,n){this.value=t&&!s(t.element)?m(e):e,this.node=t,this.attribute=n,this.sequence=[],this.expressions=[];var i=this.value.match(bt.sequence);if(i){for(var r=0,a=i.length;a>r;r++)if(i[r].match(bt.token)){var o=new kt(b(i[r]),this.node,this.attribute);this.sequence.push(o),this.expressions.push(o)}else this.sequence.push(i[r]);g(this.sequence)}};Rt.prototype={toString:function(){return"[object Interpolation]"},dispose:function(){if(this.expressions)for(var e=0,t=this.expressions.length;t>e;e++)this.expressions[e].dispose();this.value=null,this.node=null,this.attribute=null,this.sequence=null,this.expressions=null},update:function(){for(var e=-1,t=this.expressions.length;t>++e;)this.expressions[e].update()},render:function(){var e="";if(this.sequence)for(var t=0,n=this.sequence.length;n>t;t++){var i="";i=h(this.sequence[t])?this.sequence[t].value:this.sequence[t],l(i)||(i=""),e+=i}return e}};var kt=function(e,n,i){l(e)&&(this.pattern=e,this.isString=bt.string.test(e),this.node=n,this.attribute=i,this.value=this.isString?this.pattern:t,this.isString?(this.isFunction=!1,this.depth=null,this.path=null,this.params=null):(this.isFunction=p(this.pattern),this.depth=$(this.pattern),this.path=L(this.pattern),this.params=this.isFunction?V(this.pattern.match(bt.func)[2]):null))};kt.prototype={toString:function(){return"[object Expression]"},dispose:function(){this.pattern=null,this.node=null,this.attribute=null,this.path=null,this.params=null,this.value=null},update:function(){var e=this.node;if(!e&&this.attribute&&(e=this.attribute.node),e||!e.scope){var t=this.getValue(e.scope);t=S(this,t),this.value!==t&&(this.value=t,(this.node||this.attribute).invalidate=!0)}},getValue:function(e,t,n){return _(e,this.pattern,this.path,this.params,t,n)}};var St=new x,Tt=function(e){this.watchers=new x,this.node=null,this.scope=null,this.compile(e)};Tt.prototype={toString:function(){return"[object Template]"},compile:function(e){e&&(this.element=e),this.node&&this.node.dispose(),this.node=C(this,this.element),this.node.root=!0,this.scope=this.node.scope},update:function(e){l(e)&&P(this.node.scope,e),this.node&&this.node.update()},render:function(e){this.update(e),this.node&&this.node.render()},invalidate:function(){this.node&&this.node.invalidateData()},watch:function(e,t){(r(e)||a(e))&&o(t)&&this.watchers.put(e,t)},unwatch:function(e){this.watchers.remove(e)},clearWatchers:function(){this.watchers.dispose()},clearEvents:function(){this.node.clearEvents()},getNode:function(e){return this.node.getNode(e)},dispose:function(){St.remove(this.element),this.watchers&&this.watchers.dispose(),this.node&&this.node.dispose(),this.element=null,this.watchers=null,this.node=null}},W.guid=1,X.preventDefault=function(){this.returnValue=!1},X.stopPropagation=function(){this.cancelBubble=!0};var At,_t=[];if(ut.autocreate&&"object"==typeof document){var Lt=function(){function e(e){for(p=1;e=n.shift();)e()}var t,n=[],i=!1,r=document,a=r.documentElement,s=a.doScroll,o="DOMContentLoaded",l="addEventListener",u="onreadystatechange",h="readyState",p=/^loade|c/.test(r[h]);return r[l]&&r[l](o,t=function(){r.removeEventListener(o,t,i),e()},i),s&&r.attachEvent(u,t=function(){/^c/.test(r[h])&&(r.detachEvent(u,t),e())}),s?function(e){self!=top?p?e():n.push(e):function(){try{a.doScroll("left")}catch(t){return setTimeout(function(){Lt(e)},50)}e()}()}:function(e){p?e():n.push(e)}}(),Vt=function(t){for(var n=t?t.firstChild:document.body;n;){if(1===n.nodeType){Vt(n);var i=n.getAttribute(pt.template);if(i){var r=Function("return "+i+";");try{var a=r();o(a)&&e.template.bootstrap(i,n,a)}catch(s){}}}n=n.nextSibling}};Lt(Vt)}ht.start(at),ht.end(st),e.plugins=e.plugins||{};var $t=function(instance,injector){instance.constructor.prototype.createTemplate=function(t,n){if(!t||"function"!=typeof t)throw Error("Error creating a template, the first parameter must be a function.");if(n&&a(n)){var i=e.template.create(n);for(var r in i)"function"==typeof i[r]&&(t.prototype[r]=i[r].bind(i));t.prototype.render=i.render.bind(i);var s=injector.createChild();return s.mapValue("template",i),s.mapValue("scope",i.scope),s.mapValue("element",i.element),s.createInstance(t)}return null},e.template.bootstrap=function(e,t,n){instance.createTemplate(n,t)}};e.plugins&&e.plugins.add&&e.plugins.add($t),e.template.Plugin=$t,e.template.create=tt,e.template.get=nt,e.template.renderAll=it,e.template.helpers=rt,e.template.bootstrap=et,e.template.addEvent=W,e.template.removeEvent=z,e.template.parseEvents=J,e.template.clearEvents=Z,e.template.ready=Lt,"function"==typeof define&&define.amd&&define("soma-template",e.template),"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=e.template),exports=e.template)})(this.soma=this.soma||{});